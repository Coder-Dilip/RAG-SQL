# Django RAG-SQL Project
# Dilip Pokhrel
## Overview

This Django project allows users to upload SQL or SQLite files, which are then processed to generate SQL queries using the Gemini Pro LLM. The results are displayed on the frontend, providing a seamless experience for interacting with the database.

This project can be called **RAG-SQL** because it leverages a **R**etrieval-**A**ugmented **G**eneration (RAG) approach combined with SQL to generate and execute SQL queries based on user input.

Here's how it aligns with the RAG methodology:

1. **Retrieval (R)**:
   - The project retrieves relevant information from the uploaded database files (either SQL or SQLite) by analyzing the structure, extracting table names, and gathering column details. 
   - When a user query is provided, the system retrieves the relevant table names and schema information from the database, which are then used to guide the generation of SQL queries.

2. **Augmentation (A)**:
   - The retrieved information (such as table descriptions and schema) is augmented with the userâ€™s query to form a more contextually rich input for the generative model.
   - This augmentation step ensures that the generated SQL queries are accurate and aligned with the structure of the database.

3. **Generation (G)**:
   - The project uses a Large Language Model (LLM) like Gemini Pro to generate SQL queries. The LLM generates SQL code based on the augmented input (the user's query combined with the database schema).
   - This generation step is the core of the RAG approach, where the model generates the final SQL query that can be executed on the database.

In essence, **RAG-SQL** reflects the combination of retrieving and augmenting relevant database information, and then using this augmented data to generate SQL queries dynamically with the help of an LLM. The term "RAG-SQL" aptly describes the innovative approach taken in the project, integrating the RAG methodology with SQL query generation and execution.

## Features

- **File Upload**: Upload SQL or SQLite files through a web interface.
- **File Conversion**: Convert SQL files to SQLite format if needed.
- **Table Information**: Automatically generate a list of tables and their details.
- **Query Classification**: Analyze user queries to identify relevant tables.
- **SQL Generation**: Generate SQL queries based on user input and table descriptions.
- **Data Retrieval**: Fetch and display data from selected tables.

## Setup and Installation

1. **Clone the Repository**

   ```bash
   git clone https://github.com/yourusername/yourrepository.git
   cd yourrepository
   ```

2. **Create a Virtual Environment**

   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows use `venv\Scripts\activate`
   ```

3. **Install Dependencies**

   ```bash
   pip install -r requirements.txt
   ```

4. **Configure Environment Variables**

   Create a `.env` file in the project root and add your Google API key:

   ```
   GOOGLE_API_KEY=your_google_api_key
   ```

5. **Apply Migrations**

   ```bash
   python manage.py migrate
   ```

6. **Run the Development Server**

   ```bash
   python manage.py runserver
   ```

7. **Access the Application**

   Open your browser and navigate to `http://127.0.0.1:8000/` to start using the application.

## How It Works

- **`views.py`**: Handles the core logic for file uploads, conversions, query classification, and SQL generation.
  - `upload_db`: Manages file uploads, converts SQL files to SQLite, and retrieves table information.
  - `get_table_data`: Fetches data from the selected table.
  - `get_table_overview`: Provides an overview of table details and generates SQL queries.

- **HTML Templates**: Two templates are used:
  - `index.html`: The main upload page.
  - `table_list.html`: Displays the list of tables and their details.

## Usage

1. **Upload a Database File**

   Navigate to the upload page and select an SQL or SQLite file to upload.

2. **View Tables and Details**

   After uploading, view the list of tables and their details generated by the Gemini Pro LLM.

3. **Query the Database**

   Use the provided query interface to generate and execute SQL queries based on your input.

## Contributing

Feel free to fork the repository and submit pull requests. For major changes, please open an issue to discuss the changes before submitting a pull request.

## License

This project is licensed under the MIT License.

---

Let me know if you need any modifications or additional information!